new/*#__PURE__*/(function(){var e;function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),this.board=e,this.firstMove=!1,this.previousBoard=JSON.parse(JSON.stringify(this.board)),this.initControls(),this.getState()}return e=[{key:"hasBoardChanged",value:function(){return JSON.stringify(this.board)!==JSON.stringify(this.previousBoard)}},{key:"initControls",value:function(){var e=this;document.addEventListener("keydown",function(t){"ArrowLeft"===t.key?e.moveLeft():"ArrowRight"===t.key?e.moveRight():"ArrowUp"===t.key?e.moveUp():"ArrowDown"===t.key&&e.moveDown()})}},{key:"moveLeft",value:function(){for(var e=this,t=0;t<4;t++)!function(t){for(var r=e.board[t].filter(function(e){return 0!==e}),o=0;o<r.length-1;o++)r[o]===r[o+1]&&(r[o]*=2,r[o+1]=0);for(r=r.filter(function(e){return 0!==e});r.length<4;)r.push(0);e.board[t]=r}(t);if(this.hasBoardChanged()){this.previousBoard=JSON.parse(JSON.stringify(this.board)),this.addNewTile(),this.getState(),this.checkFirstMove(),this.getScore();var r=this.getStatus(),o=document.querySelector(".message-win"),i=document.querySelector(".message-lose");"win"===r?o.classList.remove("hidden"):"lose"===r&&i.classList.remove("hidden")}}},{key:"moveRight",value:function(){for(var e=this,t=0;t<4;t++)!function(t){for(var r=e.board[t].filter(function(e){return 0!==e}),o=r.length-1;o>0;o--)r[o]===r[o-1]&&(r[o]*=2,r[o-1]=0);for(r=r.filter(function(e){return 0!==e});r.length<4;)r.unshift(0);e.board[t]=r}(t);if(this.hasBoardChanged()){this.previousBoard=JSON.parse(JSON.stringify(this.board)),this.addNewTile(),this.getState(),this.checkFirstMove(),this.getScore();var r=this.getStatus(),o=document.querySelector(".message-win"),i=document.querySelector(".message-lose");"win"===r?o.classList.remove("hidden"):"lose"===r&&i.classList.remove("hidden")}}},{key:"moveUp",value:function(){for(var e=this,t=0;t<4;t++)!function(t){for(var r=[],o=0;o<4;o++)0!==e.board[o][t]&&r.push(e.board[o][t]);for(var i=0;i<r.length-1;i++)r[i]===r[i+1]&&(r[i]*=2,r[i+1]=0);for(r=r.filter(function(e){return 0!==e});r.length<4;)r.push(0);for(var s=0;s<4;s++)e.board[s][t]=r[s]}(t);if(this.hasBoardChanged()){this.previousBoard=JSON.parse(JSON.stringify(this.board)),this.addNewTile(),this.getState(),this.checkFirstMove(),this.getScore();var r=this.getStatus(),o=document.querySelector(".message-win"),i=document.querySelector(".message-lose");"win"===r?o.classList.remove("hidden"):"lose"===r&&i.classList.remove("hidden")}}},{key:"moveDown",value:function(){for(var e=this,t=0;t<4;t++)!function(t){for(var r=[],o=0;o<4;o++)0!==e.board[o][t]&&r.push(e.board[o][t]);for(var i=r.length-1;i>0;i--)r[i]===r[i-1]&&(r[i]*=2,r[i-1]=0);for(r=r.filter(function(e){return 0!==e});r.length<4;)r.unshift(0);for(var s=0;s<4;s++)e.board[s][t]=r[s]}(t);if(this.hasBoardChanged()){this.previousBoard=JSON.parse(JSON.stringify(this.board)),this.addNewTile(),this.getState(),this.checkFirstMove(),this.getScore();var r=this.getStatus(),o=document.querySelector(".message-win"),i=document.querySelector(".message-lose");"win"===r?o.classList.remove("hidden"):"lose"===r&&i.classList.remove("hidden")}}},{key:"getScore",value:function(){for(var e=0,t=0;t<4;t++)for(var r=0;r<4;r++)e+=this.board[t][r];document.querySelector(".game-score").textContent=e}},{key:"getState",value:function(){for(var e=document.querySelectorAll(".field-cell"),t=0,r=0;r<4;r++)for(var o=0;o<4;o++){var i=e[t];i.innerHTML="",i.className="field-cell";var s=this.board[r][o];if(0!==s){i.classList.add("field-cell--".concat(s));var a=document.createElement("div");a.classList.add("tile"),a.innerText=s,i.appendChild(a)}t++}}},{key:"getStatus",value:function(){var e=this.board.some(function(e){return e.includes(2048)}),t=!this.board.some(function(e){return e.includes(0)})&&!this.canMerge();return e?"win":t?"lose":"playing"}},{key:"start",value:function(){var e=this,t=document.querySelector(".message-start");document.querySelector(".start").addEventListener("click",function(){t.classList.add("hidden"),e.restart()})}},{key:"restart",value:function(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.addNewTile(),this.addNewTile(),this.getState();var e=document.querySelector(".message-win"),t=document.querySelector(".message-lose");e.classList.add("hidden"),t.classList.add("hidden"),document.querySelector(".game-score").textContent="0"}},{key:"addNewTile",value:function(){for(var e=[],t=0;t<4;t++)for(var r=0;r<4;r++)0===this.board[t][r]&&e.push({row:t,col:r});if(e.length>0){var o=e[Math.floor(Math.random()*e.length)],i=.9>Math.random()?2:4;this.board[o.row][o.col]=i,this.hasBoardChanged()&&(this.previousBoard=JSON.parse(JSON.stringify(this.board)),this.getState())}}},{key:"canMerge",value:function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++){var r=this.board[e][t];if(t<3&&r===this.board[e][t+1]||e<3&&r===this.board[e+1][t])return!0}return!1}},{key:"checkFirstMove",value:function(){this.firstMove||(this.firstMove=!0,this.changeButton())}},{key:"changeButton",value:function(){var e=document.querySelector(".start");e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart"}}],function(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,e),t}())().start();
//# sourceMappingURL=index.31aa3abd.js.map
