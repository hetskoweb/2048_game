new class{constructor(e=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.board=e,this.firstMove=!1,this.previousBoard=JSON.parse(JSON.stringify(this.board)),this.initControls(),this.getState()}hasBoardChanged(){return JSON.stringify(this.board)!==JSON.stringify(this.previousBoard)}initControls(){document.addEventListener("keydown",e=>{"ArrowLeft"===e.key?this.moveLeft():"ArrowRight"===e.key?this.moveRight():"ArrowUp"===e.key?this.moveUp():"ArrowDown"===e.key&&this.moveDown()})}moveLeft(){for(let e=0;e<4;e++){let t=this.board[e].filter(e=>0!==e);for(let e=0;e<t.length-1;e++)t[e]===t[e+1]&&(t[e]*=2,t[e+1]=0);for(t=t.filter(e=>0!==e);t.length<4;)t.push(0);this.board[e]=t}if(this.hasBoardChanged()){this.previousBoard=JSON.parse(JSON.stringify(this.board)),this.addNewTile(),this.getState(),this.checkFirstMove(),this.getScore();let e=this.getStatus(),t=document.querySelector(".message-win"),s=document.querySelector(".message-lose");"win"===e?t.classList.remove("hidden"):"lose"===e&&s.classList.remove("hidden")}}moveRight(){for(let e=0;e<4;e++){let t=this.board[e].filter(e=>0!==e);for(let e=t.length-1;e>0;e--)t[e]===t[e-1]&&(t[e]*=2,t[e-1]=0);for(t=t.filter(e=>0!==e);t.length<4;)t.unshift(0);this.board[e]=t}if(this.hasBoardChanged()){this.previousBoard=JSON.parse(JSON.stringify(this.board)),this.addNewTile(),this.getState(),this.checkFirstMove(),this.getScore();let e=this.getStatus(),t=document.querySelector(".message-win"),s=document.querySelector(".message-lose");"win"===e?t.classList.remove("hidden"):"lose"===e&&s.classList.remove("hidden")}}moveUp(){for(let e=0;e<4;e++){let t=[];for(let s=0;s<4;s++)0!==this.board[s][e]&&t.push(this.board[s][e]);for(let e=0;e<t.length-1;e++)t[e]===t[e+1]&&(t[e]*=2,t[e+1]=0);for(t=t.filter(e=>0!==e);t.length<4;)t.push(0);for(let s=0;s<4;s++)this.board[s][e]=t[s]}if(this.hasBoardChanged()){this.previousBoard=JSON.parse(JSON.stringify(this.board)),this.addNewTile(),this.getState(),this.checkFirstMove(),this.getScore();let e=this.getStatus(),t=document.querySelector(".message-win"),s=document.querySelector(".message-lose");"win"===e?t.classList.remove("hidden"):"lose"===e&&s.classList.remove("hidden")}}moveDown(){for(let e=0;e<4;e++){let t=[];for(let s=0;s<4;s++)0!==this.board[s][e]&&t.push(this.board[s][e]);for(let e=t.length-1;e>0;e--)t[e]===t[e-1]&&(t[e]*=2,t[e-1]=0);for(t=t.filter(e=>0!==e);t.length<4;)t.unshift(0);for(let s=0;s<4;s++)this.board[s][e]=t[s]}if(this.hasBoardChanged()){this.previousBoard=JSON.parse(JSON.stringify(this.board)),this.addNewTile(),this.getState(),this.checkFirstMove(),this.getScore();let e=this.getStatus(),t=document.querySelector(".message-win"),s=document.querySelector(".message-lose");"win"===e?t.classList.remove("hidden"):"lose"===e&&s.classList.remove("hidden")}}getScore(){let e=0;for(let t=0;t<4;t++)for(let s=0;s<4;s++)e+=this.board[t][s];document.querySelector(".game-score").textContent=e}getState(){let e=document.querySelectorAll(".field-cell"),t=0;for(let s=0;s<4;s++)for(let r=0;r<4;r++){let i=e[t];i.innerHTML="",i.className="field-cell";let o=this.board[s][r];if(0!==o){i.classList.add(`field-cell--${o}`);let e=document.createElement("div");e.classList.add("tile"),e.innerText=o,i.appendChild(e)}t++}}getStatus(){let e=this.board.some(e=>e.includes(2048)),t=!this.board.some(e=>e.includes(0))&&!this.canMerge();return e?"win":t?"lose":"playing"}start(){let e=document.querySelector(".message-start");document.querySelector(".start").addEventListener("click",()=>{e.classList.add("hidden"),this.restart()})}restart(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.addNewTile(),this.addNewTile(),this.getState();let e=document.querySelector(".message-win"),t=document.querySelector(".message-lose");e.classList.add("hidden"),t.classList.add("hidden"),document.querySelector(".game-score").textContent="0"}addNewTile(){let e=[];for(let t=0;t<4;t++)for(let s=0;s<4;s++)0===this.board[t][s]&&e.push({row:t,col:s});if(e.length>0){let t=e[Math.floor(Math.random()*e.length)],s=.9>Math.random()?2:4;this.board[t.row][t.col]=s,this.hasBoardChanged()&&(this.previousBoard=JSON.parse(JSON.stringify(this.board)),this.getState())}}canMerge(){for(let e=0;e<4;e++)for(let t=0;t<4;t++){let s=this.board[e][t];if(t<3&&s===this.board[e][t+1]||e<3&&s===this.board[e+1][t])return!0}return!1}checkFirstMove(){this.firstMove||(this.firstMove=!0,this.changeButton())}changeButton(){let e=document.querySelector(".start");e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart"}}().start();
//# sourceMappingURL=index.906d6b4d.js.map
